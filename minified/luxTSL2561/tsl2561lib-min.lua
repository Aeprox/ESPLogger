local a=require("i2cutils")local b="tsl2561lib"local M={TSL2561_ADDR_FLOAT=0x39,TSL2561_COMMAND_BIT=0x80,TSL2561_CONTROL_POWERON=0x03,TSL2561_CONTROL_POWEROFF=0x00,TSL2561_REGISTER_CONTROL=0x00,TSL2561_REGISTER_TIMING=0x01,TSL2561_REGISTER_ID=0x0A,TSL2561_REGISTER_CHAN0_LOW=0x0C,TSL2561_REGISTER_CHAN0_HIGH=0x0D,TSL2561_REGISTER_CHAN1_LOW=0x0E,TSL2561_REGISTER_CHAN1_HIGH=0x0F,TSL2561_INTEGRATIONTIME_13MS=0x00,TSL2561_INTEGRATIONTIME_101MS=0x01,TSL2561_INTEGRATIONTIME_402MS=0x02,TSL2561_GAIN_0X=0x00,TSL2561_GAIN_16X=0x10}_G[b]=M;local c=0;local function d(e)a.write_reg(e,bit.bor(M.TSL2561_COMMAND_BIT,M.TSL2561_REGISTER_CONTROL),M.TSL2561_CONTROL_POWERON)end;local function f(e)a.write_reg(e,bit.bor(M.TSL2561_COMMAND_BIT,M.TSL2561_REGISTER_CONTROL),M.TSL2561_CONTROL_POWEROFF)end;local function g(e,h,i)a.write_reg(e,bit.bor(M.TSL2561_COMMAND_BIT,M.TSL2561_REGISTER_TIMING),bit.bor(h,i))end;local function j(e)local k=a.read_reg(e,bit.bor(M.TSL2561_COMMAND_BIT,M.TSL2561_REGISTER_CHAN0_LOW))local l=a.read_reg(e,bit.bor(M.TSL2561_COMMAND_BIT,M.TSL2561_REGISTER_CHAN0_HIGH))ch0=string.byte(k)+string.byte(l)*256;local m=a.read_reg(e,bit.bor(M.TSL2561_COMMAND_BIT,M.TSL2561_REGISTER_CHAN1_LOW))local n=a.read_reg(e,bit.bor(M.TSL2561_COMMAND_BIT,M.TSL2561_REGISTER_CHAN1_HIGH))ch1=string.byte(m)+string.byte(n)*256;return ch0,ch1 end;function M.getchannels()e=M.TSL2561_ADDR_FLOAT;i2c.setup(c,SDA_PIN,SCL_PIN,i2c.SLOW)result=a.read_reg(e,bit.bor(M.TSL2561_COMMAND_BIT,M.TSL2561_REGISTER_ID))d(e)g(e,M.TSL2561_INTEGRATIONTIME_402MS,M.TSL2561_GAIN_16X)f(e)tmr.delay(1000)d(e)tmr.delay(500000)ch0,ch1=j(e)f(e)return ch0,ch1 end;return M