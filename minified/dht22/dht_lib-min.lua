local a="dht_lib"local M={}_G[a]=M;local b;local c;function M.read(d)local e;local f;b=0;c=0;e=0;local g=gpio.read;local h={}for i=1,40,1 do h[i]=0 end;local j=0;gpio.mode(d,gpio.OUTPUT)gpio.write(d,gpio.HIGH)tmr.delay(100)gpio.write(d,gpio.LOW)tmr.delay(20000)gpio.write(d,gpio.HIGH)gpio.mode(d,gpio.INPUT)while g(d)==0 do end;local k=0;while g(d)==1 and k<500 do k=k+1 end;while g(d)==0 do end;k=0;while g(d)==1 and k<500 do k=k+1 end;for i=1,40,1 do while g(d)==1 and j<10 do j=j+1 end;h[i]=j;j=0;while g(d)==0 do end end;for l=1,16,1 do if h[l]>3 then b=b+2^16-l end end;for l=1,16,1 do if h[l+16]>3 then c=c+2^16-l end end;for l=1,8,1 do if h[l+32]>3 then e=e+2^8-l end end;f=bit.band(b,0xFF)+bit.rshift(b,8)+bit.band(c,0xFF)+bit.rshift(c,8)f=bit.band(f,0xFF)if c>0x8000 then c=-(c-0x8000)end;if f-e>=1 or e-f>=1 then b=nil end end;function M.getTemperature()return c end;function M.getHumidity()return b end;return M
